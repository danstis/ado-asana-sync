# Run all environments in parallel: tox
[tox]
envlist = pytest,ruff,mypy
skipsdist = true
parallel = true

# Use tox for orchestration, uv for execution
[testenv]
allowlist_externals = uv
setenv =
    PYTHONPATH = {toxinidir}
commands =
    uv sync --dev

# Run with: tox -e pytest
[testenv:pytest]
description = Run full pytest with coverage
commands =
    uv run pytest --cov=. --cov-report=xml --cov-config=tox.ini --cov-branch

# Run with: tox -e ruff
[testenv:ruff]
description = Run ruff linting, formatting, and security checks
commands = 
    uv run ruff check ado_asana_sync
    uv run ruff format --check ado_asana_sync

# Run with: tox -e mypy
[testenv:mypy]
description = Run static type checks
commands = uv run mypy ado_asana_sync --ignore-missing-imports

# Coverage configuration for pytest coverage plugin
[coverage:run]
relative_files = true
omit =
    tests/*
